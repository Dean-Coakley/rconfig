import{u as x}from"./ViewFunctions-2a186a7b.js";import{P as O}from"./PageHeader-e6711cd0.js";import{D as A}from"./DataTableToolbar-aaed2697.js";import{D as V}from"./DataTableSpinner-5345de96.js";import{D as F,a as N,u as j,b as H}from"./DeleteModal-5b0a1f8e.js";import{_ as M,e as R,f as v,i as E,y as z,r as b,o as s,c as l,a,b as C,w as q,B as K,F as y,k as D,q as L,t as k,h as c,l as S,j as h,m as G,g as P}from"./app-6622b7bb.js";import{S as J}from"./SideDrawer-bf323a81.js";import{L as Q}from"./LoadingSpinner-ac941554.js";/* empty css            */const U={components:{DataTableToolbar:A,DataTableSpinner:V,DataTableEmptyState:F,DataTablePaginate:N},props:{pagename:{type:String},tabledata:{type:Object,required:[]},searchInputDisabled:{type:Boolean,default:!0},newBtnEnabled:{type:Boolean,default:!0},taskRunBtnEnabled:{type:Boolean,default:!1},editBtnEnabled:{type:Boolean,default:!0},rowViewBtnEnabled:{type:Boolean,default:!1}},emits:["openDrawer","deleteRow","pagechanged","showTaskRunConfirmModal","actionLink","viewAction"],setup(r,{emit:o}){const t=R({pageParams:{page:1,per_page:10,filters:null,sortby:"created_at",sortOrder:"desc"},sortIcon:{base:"fas fa-arrows-alt-v",is:"fa-sort",up:"fas fa-long-arrow-alt-up",down:"fas fa-long-arrow-alt-down"}}),e=R({critical:"fas fa-exclamation-circle pf-u-danger-color-100",error:"fas fa-exclamation-circle pf-u-danger-color-100",warn:"fa fa-exclamation-triangle pf-u-warning-color-100",info:"fas fa-fw fa-info-circle pf-u-info-color-100",default:"fas fa-fw fa-info-circle pf-u-info-color-100"}),_=v(t.sortIcon.base),m=v(0);E("create-notification");const{setupResizableTable:u}=j();z(()=>{r.tabledata.isLoading||u()});function p(d,B=!1){o("openDrawer",{id:d,isClone:B})}function f(d){o("deleteRow",d)}function g(){t.pageParams.filters="",o("pagechanged",t.pageParams)}function n(d){t.pageParams.filters=d,o("pagechanged",t.pageParams)}function i(d){t.pageParams.page=d.page,t.pageParams.per_page=d.per_page,o("pagechanged",t.pageParams)}function w(d,B){_.value=t.pageParams.sortOrder==="desc"?t.sortIcon.down:t.sortIcon.up,m.value=B,t.pageParams.sortby=d,t.pageParams.sortOrder=t.pageParams.sortOrder==="desc"?"asc":"desc",o("pagechanged",t.pageParams)}function T(d){o("showTaskRunConfirmModal",d)}function I(d){o("viewAction",d),close()}return{activityLogIconTable:e,addFilters:n,clearFilters:g,data:t,deleteRow:f,emitShowTaskRunConfirmModal:T,isSorted:m,openDrawer:p,pageChanged:i,sortBy:w,sortIcon:_,viewAction:I}}},W={class:"pf-c-drawer__content pf-m-no-background"},X={class:"pf-c-drawer__body pf-m-padding"},Y={class:"pf-c-card"},Z={class:"pf-c-table pf-m-compact pf-m-grid-lg",role:"grid",id:"resizeMe"},$={role:"row",id:"headerRow"},ee={key:0},te=["onClick"],ae={class:"pf-c-table__button-content"},oe={class:"pf-c-table__text"},ne={class:"pf-c-table__sort-indicator"},se=a("th",{class:"pf-c-table__icon pf-m-fit-content",role:"columnheader",scope:"col"},"Actions",-1),le={key:1,role:"rowgroup"},ie=["data-label"],re={key:0},de={key:1},ce={key:0},pe=["onClick"],fe={key:1},_e={key:2,class:"pf-u-danger-color-100",id:"form-help-textinfo-helper","aria-live":"polite"},me=a("span",{class:"pf-u-danger-color-100"},[a("i",{class:"fas fa-exclamation-circle","aria-hidden":"true"})],-1),ue=a("a",{href:"/commands",class:"alink"},"Configure",-1),be={role:"cell","data-label":"Actions",class:"pf-m-fit-content"},ge=["onClick"],we=a("span",{class:"pf-c-button__icon pf-m-start"},[a("i",{class:"fa fa-play-circle","aria-hidden":"true"})],-1),ke=["onClick"],he=a("span",{class:"pf-c-button__icon pf-m-start"},[a("i",{class:"fas fa-edit","aria-hidden":"true"})],-1),ye=["onClick"],ve=a("span",{class:"pf-c-button__icon pf-m-start"},[a("i",{class:"fas fa-search","aria-hidden":"true"})],-1),Ce=["onClick"],De=a("span",{class:"pf-c-button__icon pf-m-start"},[a("i",{class:"fas fa-trash","aria-hidden":"true"})],-1);function Re(r,o,t,e,_,m){const u=b("data-table-toolbar"),p=b("data-table-spinner"),f=b("data-table-empty-state"),g=b("data-table-paginate");return s(),l("div",W,[a("div",X,[a("div",Y,[C(u,{pagename:t.pagename,onSearchInput:o[0]||(o[0]=n=>e.addFilters(n)),onOpenDrawer:o[1]||(o[1]=n=>e.openDrawer(n)),newBtnEnabled:t.newBtnEnabled,searchInputDisabled:t.searchInputDisabled},{customButtons:q(()=>[K(r.$slots,"customButtons")]),_:3},8,["pagename","newBtnEnabled","searchInputDisabled"]),a("table",Z,[a("thead",null,[a("tr",$,[(s(!0),l(y,null,D(t.tabledata.headers,(n,i)=>(s(),l("th",{key:n.name,class:L(["pf-m-truncate pf-c-table__sort pf-c-table__icon",e.isSorted===i?"pf-m-selected":""])},[n.sortable?c("",!0):(s(),l("span",ee,k(n.label),1)),n.sortable?(s(),l("button",{key:1,class:"pf-c-table__button",onClick:w=>e.sortBy(n.key,i)},[a("div",ae,[a("span",oe,k(n.label),1),a("span",ne,[a("i",{class:L(e.isSorted===i?e.sortIcon:e.data.sortIcon.base)},null,2)])])],8,te)):c("",!0)],2))),128)),se])]),t.tabledata.isLoading?(s(),S(p,{key:0})):c("",!0),t.tabledata.data.total>0||t.tabledata.isLoading?(s(),l("tbody",le,[(s(!0),l(y,null,D(t.tabledata.data.data,n=>(s(),l("tr",{role:"row",key:n.name},[(s(!0),l(y,null,D(t.tabledata.headers,i=>(s(),l("td",{key:i.label,role:"cell","data-label":i.label},[i.isRelationShip===!0?(s(),l("div",re,[(s(!0),l(y,null,D(n[i.key],w=>(s(),l("div",{key:w.id},k(w[i.relationshipKey]),1))),128))])):(s(),l("div",de,[i.isActionLink?(s(),l("span",ce,[a("button",{class:"pf-c-button pf-m-link pf-m-inline",type:"button",onClick:w=>r.$emit("actionLink",n[i.key])},k(n[i.key]),9,pe)])):!i.hasEnabledIcon&&!["report_id"].includes(i.key)?(s(),l("span",fe,k(n[i.key]),1)):c("",!0)])),n.command&&n.command.length<=0&&i.error?(s(),l("p",_e,[me,h(" This category does not have any commands - "),ue])):c("",!0)],8,ie))),128)),a("td",be,[a("div",null,[t.taskRunBtnEnabled?(s(),l("button",{key:0,class:"pf-c-button pf-m-link pf-m-small",type:"button",onClick:i=>e.emitShowTaskRunConfirmModal(n.id),alt:"Start this task now!",title:"Start this task now!"},[we,h(" Start ")],8,ge)):c("",!0),t.editBtnEnabled?(s(),l("button",{key:1,class:"pf-c-button pf-m-link pf-m-small",type:"button",onClick:i=>e.openDrawer(n.id),alt:"Edit",title:"Edit"},[he,h(" Edit ")],8,ke)):c("",!0),t.rowViewBtnEnabled?(s(),l("button",{key:2,class:"pf-c-button pf-m-link pf-m-small",type:"button",onClick:i=>e.viewAction(n.id),alt:"View Details",title:"View Details"},[ve,h(" View Details ")],8,ye)):c("",!0),a("button",{class:"pf-c-button pf-m-link pf-m-danger pf-m-small",type:"button",onClick:i=>e.deleteRow(n.id),alt:"Delete",title:"Delete"},[De,h(" Delete ")],8,Ce)])])]))),128))])):t.tabledata.isLoading?c("",!0):(s(),S(f,{key:2,onClear:e.clearFilters},null,8,["onClear"]))]),C(g,{from:t.tabledata.data.from,to:t.tabledata.data.to,total:t.tabledata.data.total,current_page:t.tabledata.data.current_page,last_page:t.tabledata.data.last_page,onPagechanged:o[2]||(o[2]=n=>e.pageChanged(n))},null,8,["from","to","total","current_page","last_page"])])])])}const Se=M(U,[["render",Re]]),Be={props:{report_id:{type:String,required:!0}},emits:["closeModal"],components:{LoadingSpinner:Q},setup(r,{emit:o}){const t=E("create-notification"),e=v(null),_=v(""),m=v(!1);G(e,f=>p()),P(()=>{u()});function u(){axios.get("/api/reports/"+r.report_id).then(f=>{_.value=f.data,m.value=!1}).catch(f=>{_.value='<h1 class="text-center" style="color: #cc0000;">Error: File not Found!</h1>',m.value=!1,t({type:"danger",title:"Error",message:f.response})})}function p(){o("closeModal")}return{isLoading:m,reportHtml:_,clickOutsidetarget:e,close:p}}},Le={class:"pf-c-backdrop"},Me={class:"pf-l-bullseye"},Ee={class:"pf-c-modal-box pf-m-lg","aria-modal":"true",ref:"clickOutsidetarget"},Pe=a("i",{class:"fas fa-times","aria-hidden":"true"},null,-1),Te=[Pe],Ie={key:1,class:"pf-c-modal-box__body"},xe={id:"modal-lg-description"},Oe=["innerHTML"],Ae={key:2,class:"pf-c-modal-box__footer"};function Ve(r,o,t,e,_,m){const u=b("loading-spinner");return s(),l("div",Le,[a("div",Me,[a("div",Ee,[C(u,{showSpinner:e.isLoading},null,8,["showSpinner"]),e.isLoading?c("",!0):(s(),l("button",{key:0,class:"pf-c-button pf-m-plain",type:"button","aria-label":"Close dialog",onClick:o[0]||(o[0]=(...p)=>e.close&&e.close(...p))},Te)),e.isLoading?c("",!0):(s(),l("div",Ie,[a("p",xe,[a("span",{innerHTML:e.reportHtml},null,8,Oe)])])),e.isLoading?c("",!0):(s(),l("footer",Ae,[a("button",{class:"pf-c-button pf-m-link",type:"button",onClick:o[1]||(o[1]=p=>e.close())},"Close")]))],512)])])}const Fe=M(Be,[["render",Ve]]),Ne={components:{PageHeader:O,DataTableDownloadReports:Se,SideDrawer:J,DeleteModal:H,ModalReport:Fe},setup(){const r=R({editid:0,pagename:"Download Reports",pagedesc:"rConfig task download reports",pagenamesingle:"Report",modelName:"reports",openDrawerState:!1,showDeleteModal:!1,reportModalState:!1,sideDrawerComponentKey:1,viewReportId:0,pageOptionsState:{page:1,per_page:10,sortby:"created_at",sortOrder:"desc"},modelObject:{report_id:"",task_id:null,task_name:"",task_desc:"",task_type:"",file_name:"",start_time:"",end_time:"",duration:null,created_at:"",updated_at:""}}),{models:o,isLoading:t,dataTablePageChanged:e,deleteRow:_,confirmDelete:m,destroyModel:u}=x(r,r.modelName,r.modelObject);P(()=>{e(r.pageOptionsState)});const p=R({headers:[{key:"report_id",label:"Report",sortable:!0,isActionLink:!0,actionLink:{label:"Download",action:"viewReport"}},{key:"task_id",label:"Task ID",sortable:!0},{key:"task_name",label:"Task Name",sortable:!1},{key:"created_at",label:"Created",sortable:!0}],data:o,isLoading:t});function f(g){r.viewReportId=g,r.reportModalState=!0}return{viewstate:r,dataTablePageChanged:e,deleteRow:_,confirmDelete:m,table:p,destroyModel:u,viewReport:f}}},je={class:"pf-c-page__main",tabindex:"-1"},He=a("div",{class:"pf-c-divider",role:"separator"},null,-1),ze={class:"pf-c-page__main-section pf-m-no-padding"},qe={class:"pf-c-drawer__main"};function Ke(r,o,t,e,_,m){const u=b("page-header"),p=b("data-table-download-reports"),f=b("delete-modal"),g=b("modal-report");return s(),l(y,null,[a("main",je,[C(u,{pagename:e.viewstate.pagename,desc:e.viewstate.pagedesc},null,8,["pagename","desc"]),He,a("section",ze,[a("div",{class:L(["pf-c-drawer",{"pf-m-expanded":e.viewstate.openDrawerState}])},[a("div",qe,[C(p,{pagename:e.viewstate.pagenamesingle,tabledata:e.table,onPagechanged:e.dataTablePageChanged,onDeleteRow:o[0]||(o[0]=n=>e.deleteRow(n)),onActionLink:o[1]||(o[1]=n=>e.viewReport(n)),newBtnEnabled:!1,editBtnEnabled:!1},null,8,["pagename","tabledata","onPagechanged"])])],2)])]),e.viewstate.showDeleteModal?(s(),S(f,{key:0,editid:e.viewstate.editid,onCloseModal:o[2]||(o[2]=n=>e.viewstate.showDeleteModal=!1),onConfirmDelete:e.confirmDelete},null,8,["editid","onConfirmDelete"])):c("",!0),e.viewstate.reportModalState?(s(),S(g,{key:1,onCloseModal:o[3]||(o[3]=n=>e.viewstate.reportModalState=!1),report_id:e.viewstate.viewReportId},null,8,["report_id"])):c("",!0)],64)}const et=M(Ne,[["render",Ke]]);export{et as default};
